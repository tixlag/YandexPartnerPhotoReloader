# Yandex Market Photo Reuploader


1. Нажмите **«Запустить браузер»**.
2. В открывшемся Chrome войдите под своим аккаунтом.
3. Вернитесь в программу и нажмите **«Сохранить cookies»**.
4. Выберите кабинет из списка
5. Нажмите **«Получить campaignId для выбранного кабинета»** (в логе появится `campaignId`).
6. Нажмите **«Загрузить XLSX (остатки)»** и выберите файл, выгруженный из вкладки **Остатки на складе** в личном кабинете.
7. Нажмите **«Запустить обработку»**.
8. Если появится капча — решите её в браузере и нажмите **«Продолжить после капчи»**.

---

## Простые решения распространённых проблем

* **Не видит кабинеты**
  Убедитесь, что в браузере открыта страница настроек кабинета:
  `https://partner.market.yandex.ru/business/{ID}/settings?activeTab=all`
  После этого нажмите **«Считать кабинеты с текущей страницы»**.

* **Excel не распознаётся / нет колонки SKU**
  Убедитесь, что это экспорт `.xlsx` из вкладки **Остатки на складе** и что в шапке есть колонка «Ваш SKU», «SKU» или «Артикул».

* **Файл из другого кабинета**
  Программа читает ID в файле (ячейка B3) и предупредит, если он не совпадает с выбранным кабинетом. Отмените загрузку или продолжите по своему выбору.

* **Открылся диалог выбора файла (нативный)**
  Закройте диалог, нажмите **«Прервать»** в программе и запустите обработку заново — не кликайте вручную по кнопкам в браузере.

* **Проблемы с драйвером / браузером**
  Убедитесь, что Chrome установлен. Если есть ошибка webdriver — обновите Selenium / используйте актуальный chromedriver или Selenium Manager.

---

## Как снова обработать товары

* По умолчанию уже обработанные SKU пропускаются.
* Чтобы обработать заново — выключите **«Пропускать уже обработанные»** или удалите файл `processed_items.sqlite3` (если нужно начать с нуля).

---

## Безопасность

* Не отправляйте файл `cookies.pkl` другим людям — это доступ к вашему аккаунту.
* Используйте учётную запись с правами только на необходимые кабинеты.

---

## Если не помогло

1. Скопируйте текст из лога (нижнее окно программы).
2. Пришлите лог + описание шага, на котором остановилось.
3. Я помогу быстро разобраться.